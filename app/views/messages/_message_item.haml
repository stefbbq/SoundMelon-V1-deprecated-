- unless message.blank?
  - read_message  = message.is_read?(@user)
  - msg_div_class = read_message ? "msgstremitem-read" : "msgstremitem-unread"
  - sender        = message.sender
  - self_message  = @user == sender
  - sender_detail = actor_detail(message.sender)
  - avatar        = sender.is_fan? ? get_avatar_small(sender) : get_band_logo_small(message.sender)
  - sender_type   = message.sender_type
  - sender        = message.sender
  .message.entry{:id=>"msg_box_#{message.id}"}
    %div
      .avatar
        - if self_message
          = avatar
        - else
          = link_to avatar, sender_detail[:link], :class =>'ajaxopen backable', :remote =>:true
      .content{:class =>"#{msg_div_class}"}
        .header{:id=>"msg_item_#{message.id}"}
          .title
            %strong
            - if self_message
              = sender_detail[:name]
            - else
              = link_to sender_detail[:name], sender_detail[:link], :class =>'ajaxopen backable', :remote =>:true
            #{timeago(message.created_at)}
          .actions
            = link_to message_path(message), :method => :delete, :class => 'action-delete ajaxload', :remote => true do
              %i
              %span delete
            = link_to message_path(message), :class=>'action-delete ajaxload', :remote => true do
              %i
              %span view
        .body{:id =>"msg_content_#{message.id}"}
          = message.body.truncate(40)
      .clear